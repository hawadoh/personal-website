<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Classical tolerant identity test for multiple EPR states | ùóßùóòùóî‚Ä¢ùóòùóöùóö</title><meta name=keywords content><meta name=description content="With the tolerant identity test for a single state $\rho_{AB}$ complete, we now turn to the problem of certifying multiple EPR pairs. For brevity we write

$$
\rho = \rho_{AB},
\qquad
\Phi = \ket{\text{EPR}}\bra{\text{EPR}}_{AB}.
$$In particular, we will show how the same matching-outcomes protocol extends in three settings of increasing generality and difficulty:


Easy (i.i.d. copies).
All $n$ copies are identical:

$$
     \rho^{\otimes n}\quad\text{vs.}\quad\Phi^{\otimes n}.
   $$

Medium (independent, non-identical copies).
Each copy may differ but remains uncorrelated:
"><meta name=author content="Howard Cheung"><link rel=canonical href=https://teaegg.net/research/urss/n-epr-test/><link crossorigin=anonymous href=/assets/css/stylesheet.12d2e5fe7e7a6b449beaee7514d9f08063da1272468eea14524da628ddfaabb5.css integrity="sha256-EtLl/n56a0Sb6u51FNnwgGPaEnJGjuoUUk2mKN36q7U=" rel="preload stylesheet" as=style><link rel=icon href=https://teaegg.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://teaegg.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://teaegg.net/favicon-32x32.png><link rel=apple-touch-icon href=https://teaegg.net/apple-touch-icon.png><link rel=mask-icon href=https://teaegg.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://teaegg.net/research/urss/n-epr-test/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\[",right:"\\]",display:!0},{left:"\\(",right:"\\)",display:!1}]})})</script><link rel=icon type=image/png href=/favicon-96x96.png sizes=96x96><link rel=icon type=image/svg+xml href=/favicon.svg><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><meta name=apple-mobile-web-app-title content="Teaegg"><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://teaegg.net/research/urss/n-epr-test/"><meta property="og:site_name" content="ùóßùóòùóî‚Ä¢ùóòùóöùóö"><meta property="og:title" content="Classical tolerant identity test for multiple EPR states"><meta property="og:description" content="With the tolerant identity test for a single state $\rho_{AB}$ complete, we now turn to the problem of certifying multiple EPR pairs. For brevity we write $$ \rho = \rho_{AB}, \qquad \Phi = \ket{\text{EPR}}\bra{\text{EPR}}_{AB}. $$In particular, we will show how the same matching-outcomes protocol extends in three settings of increasing generality and difficulty:
Easy (i.i.d. copies).
All $n$ copies are identical: $$ \rho^{\otimes n}\quad\text{vs.}\quad\Phi^{\otimes n}. $$ Medium (independent, non-identical copies).
Each copy may differ but remains uncorrelated: "><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="research"><meta property="article:published_time" content="2025-08-08T17:42:31+01:00"><meta property="article:modified_time" content="2025-08-08T17:42:31+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Classical tolerant identity test for multiple EPR states"><meta name=twitter:description content="With the tolerant identity test for a single state $\rho_{AB}$ complete, we now turn to the problem of certifying multiple EPR pairs. For brevity we write

$$
\rho = \rho_{AB},
\qquad
\Phi = \ket{\text{EPR}}\bra{\text{EPR}}_{AB}.
$$In particular, we will show how the same matching-outcomes protocol extends in three settings of increasing generality and difficulty:


Easy (i.i.d. copies).
All $n$ copies are identical:

$$
     \rho^{\otimes n}\quad\text{vs.}\quad\Phi^{\otimes n}.
   $$

Medium (independent, non-identical copies).
Each copy may differ but remains uncorrelated:
"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"üî¨ Research","item":"https://teaegg.net/research/"},{"@type":"ListItem","position":2,"name":"üîêüí° Undergraduate Research Support Scheme (URSS)","item":"https://teaegg.net/research/urss/"},{"@type":"ListItem","position":3,"name":"Classical tolerant identity test for multiple EPR states","item":"https://teaegg.net/research/urss/n-epr-test/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Classical tolerant identity test for multiple EPR states","name":"Classical tolerant identity test for multiple EPR states","description":"With the tolerant identity test for a single state $\\rho_{AB}$ complete, we now turn to the problem of certifying multiple EPR pairs. For brevity we write $$ \\rho = \\rho_{AB}, \\qquad \\Phi = \\ket{\\text{EPR}}\\bra{\\text{EPR}}_{AB}. $$In particular, we will show how the same matching-outcomes protocol extends in three settings of increasing generality and difficulty:\nEasy (i.i.d. copies).\nAll $n$ copies are identical: $$ \\rho^{\\otimes n}\\quad\\text{vs.}\\quad\\Phi^{\\otimes n}. $$ Medium (independent, non-identical copies).\nEach copy may differ but remains uncorrelated: ","keywords":[],"articleBody":"With the tolerant identity test for a single state $\\rho_{AB}$ complete, we now turn to the problem of certifying multiple EPR pairs. For brevity we write $$ \\rho = \\rho_{AB}, \\qquad \\Phi = \\ket{\\text{EPR}}\\bra{\\text{EPR}}_{AB}. $$In particular, we will show how the same matching-outcomes protocol extends in three settings of increasing generality and difficulty:\nEasy (i.i.d. copies).\nAll $n$ copies are identical: $$ \\rho^{\\otimes n}\\quad\\text{vs.}\\quad\\Phi^{\\otimes n}. $$ Medium (independent, non-identical copies).\nEach copy may differ but remains uncorrelated: $$ \\rho_1\\otimes\\rho_2\\otimes\\dots\\otimes\\rho_n \\quad\\text{vs.}\\quad \\Phi^{\\otimes n}. $$ Hard (arbitrary adversary).\nThe most general case allows an arbitrary $2n$-qubit state $\\rho$, possibly entangled across copies, against which we still wish to test closeness to $\\Phi^{\\otimes n}$.\nWe will analyse the number of protocol rounds, $N$, required to certify $n$ EPR pairs.\nCan we achieve the same sample complexity $$ N = O\\!\\left(n^2\\,(\\varepsilon_2^2 - \\varepsilon_1^2)^{-2}\\right)\\!. $$ in all three cases?\nNote. In the context of BB'84, these three scenarios correspond directly to the class of attacks that an eavesdropper (Eve) might do:\nEasy (i.i.d. copies): Eve applies the same attack channel to each transmitted qubit independently, with no memory from one round to the next. Every round she starts from scratch, so her joint state is $\\rho^{\\otimes n}$.\nMedium (independent, non-identical copies): Eve still treats each qubit independently and measures immediately, but she may choose a different attack in each round. Her overall state is the product $\\rho_{1}\\otimes\\rho_{2}\\otimes\\dots\\otimes\\rho_{n}$.\nHard (arbitrary adversary): Eve may entangle her systems across rounds and defer all measurements until the end. There is no tensor-product structure, so her state is an arbitrary $2n$-qubit $\\rho$.\nBy proving security in each model, starting with the easiest and working up to the fully coherent setting, we obtain a hierarchy of BB'84 security guarantees that mirror the increasing power of potential attack by Eve. From the sample complexity, we will see that a fully coherent attack (hard case) isn‚Äôt more difficult to detect than a simple i.i.d. tensor product state (easy case)! \u003c- not sure about this yet\nWe begin with the i.i.d. case as it‚Äôs both the simplest to analyse and a useful building block for the more challenging scenarios.\nEasy case (i.i.d. copies) A na√Øve per-copy approach using trace distance A first idea is to ignore the joint state altogether and simply run the single-pair tolerant test on each of the $n$ copies separately, then accept only if every individual test passes. Equivalently, one could tally the per-copy mismatch indicators into a total error count and compare that sum against a scaled threshold (thanks to the i.i.d. assumption). At first glance this seems painless, but a closer look shows it is actually worse than the collective strategy developed below.\nRecall for a single copy $\\rho$: $$ D_1 ~=~ D(\\rho,\\Phi), $$ and in the $n$-copy i.i.d. case we have the bound $$ D_n ~:=~ D\\bigl(\\rho^{\\otimes n},\\,\\Phi^{\\otimes n}\\bigr) ~\\leq~ n\\,D_1. $$ Per-copy tolerance must shrink. To guarantee that the full product state satisfies $D(\\rho^{\\otimes n},\\Phi^{\\otimes n}) \\leq \\varepsilon_1$, the trace-distance of each copy must be at most $\\varepsilon_1/n$; otherwise the sub-additivity bound $D_n\\leq nD_1$ could exceed $\\varepsilon_1$. Promise gap narrows by a factor $n$. Replacing $\\varepsilon_j$ by $\\varepsilon_j/n$ shrinks the gap $\\varepsilon_2^2 - \\varepsilon_1^2$ by $n^{2}$. For the single-pair test the sample size scales as the inverse square of that gap, so one copy now needs $$ O\\bigl(n^{4}(\\varepsilon_2^2-\\varepsilon_1^2)^{-2}\\bigr) $$ samples. Replicated testing scales linearly. Running $n$ such tests and combining them multiplies the sample cost by $n$. Hence by a very high-level analysis, we obtain a cost for the na√Øve strategy $$ N_{\\text{na√Øve}} ~=~ O\\bigl(n^{5}(\\varepsilon_2^2-\\varepsilon_1^2)^{-2}\\bigr), $$ which is three full powers of $n$ ($n^{5}$ vs. $n^{2}$) worse than the collective $n$-copy analysis we develop below. The lesson is that testing each pair in isolation achieves a stronger (per-copy) guarantee than we need and pays a steep statistical price; exploiting the product structure directly using just one global test is markedly more efficient.\nGlobal block test using fidelity For a single copy $\\rho$: $$ F_1 ~=~ F(\\rho,\\Phi), \\quad D_1 ~=~ D(\\rho,\\Phi), $$ and in the $n$-copy i.i.d. case we have the rules $$ F_n ~:=~ F\\bigl(\\rho^{\\otimes n},\\,\\Phi^{\\otimes n}\\bigr) ~=~ F_1^{n}, \\qquad D_n ~:=~ D\\bigl(\\rho^{\\otimes n},\\,\\Phi^{\\otimes n}\\bigr) ~\\leq~ n\\,D_1. $$ This means we can express the $n$-copy closeness conditions entirely in terms of the single-copy fidelity $F_1$, thanks to the exact tensor-product rule $F(\\rho^{\\otimes n},\\Phi^{\\otimes n}) = F(\\rho,\\Phi)^n$ (or equivalently $F_n = F_1^n$). Working directly with fidelity avoids the looser trace-distance bound $D(\\rho^{\\otimes n},\\Phi^{\\otimes n}) \\leq n\\,D(\\rho,\\Phi)$, which would give a much weaker bound than the tight scaling we get from fidelity.\nTranslating hypotheses Our goal is to distinguish $$ \\begin{cases} ~\\mathbf{H_0}: \u0026D_n \\,\\leq\\,\\varepsilon_1 \\quad\\iff\\quad \\rho^{\\otimes n}\\text{ is ‚Äúclose‚Äù to }\\Phi^{\\otimes n},\\\\[6pt] ~\\mathbf{H_1}: \u0026D_n \\,\\geq\\,\\varepsilon_2 \\quad\\iff\\quad \\rho^{\\otimes n}\\text{ is ‚Äúfar‚Äù from }\\Phi^{\\otimes n}, \\end{cases} $$ with $0 \\leq \\varepsilon_1 \u003c \\varepsilon_2 \\leq 1$. By Fuchs‚Äìvan de Graaf, $$ 1 - F_n ~\\leq~ D_n ~\\leq~ \\sqrt{1 - F_n^{2}}, $$ so controlling $F_n$ tightly leads to a corresponding control on $D_n$. Since $F_n = F_1^{n}$, we can use this and the upper bound of Fuchs‚Äìvan de Graaf to rewrite the hypotheses as fidelity conditions per-copy: $$ \\begin{cases} ~\\mathbf{H_0}: \\quad \u0026D_n \\,\\leq\\,\\varepsilon_1 \u0026\\impliedby \u0026F_n^2 ~\\geq~ 1 - \\varepsilon_1^2 \u0026\\iff \u0026F_1 ~\\geq~ (1 - \\varepsilon_1^2)^{1/(2n)} \\\\[4pt] ~\\mathbf{H_1}: \\quad \u0026D_n \\,\\geq\\,\\varepsilon_2 \u0026\\implies \u0026F_n^2 ~\\leq~ 1 - \\varepsilon_2^2 \u0026\\iff \u0026F_1 ~\\leq~ (1 - \\varepsilon_2^2)^{1/(2n)} \\end{cases}\\quad. $$You might be wondering why we need a sufficient condition for $\\mathbf{H_0}$ and a necessary condition for $\\mathbf{H_1}$. This is because we need to guarantee that accepted states are truly close (requiring a sufficient condition) and that far states are rejected (requiring a necessary condition) to prevent false accepts.\nSoundness of acceptance (Accept $\\Rightarrow$ Close; avoid false accepts). Why do we use a ‚Äúsufficient‚Äù $F\\!\\to\\!D$ direction? We want ‚Äúif the test accepts, the global state is close‚Äù, i.e. no false accept. That needs an upper bound on distance from fidelity, which comes from the right-hand FvG: $$ D_n \\leq \\sqrt{1 - F_n^2}. $$ So we enforce $F_n \\geq \\sqrt{1 - \\varepsilon_1^2}$ (equivalently $F_1 \\geq (1 - \\varepsilon_1^2)^{1/(2n)}$), which forces $D_n \\leq \\varepsilon_1$. If instead you used the left-hand side $1 - F_n \\leq D_n$ with a threshold $F_n \\geq 1-\\varepsilon_1$, you could falsely accept a far state. Example: take $\\varepsilon_1 = 0.1$ and a state with $F_n = 0.90$. The right-hand FvG still allows $D_n$ to be as high as $\\sqrt{1 - 0.9^2} \\approx 0.436 \u003e 0.1$, so the state could be far from the target yet would be accepted by this flawed rule.\nSoundness of rejection (Far $\\Rightarrow$ Reject; again avoid false accepts). Why do we use a ‚Äúnecessary‚Äù $D\\!\\to\\!F$ direction? We want every far state to be rejected, i.e. no false accept. We start from ‚Äúfar $\\Rightarrow$ small fidelity‚Äù, and again consider the right-hand FvG: $$ D_n \\geq \\varepsilon_2 \\implies F_n \\leq \\sqrt{1 - \\varepsilon_2^2}. $$ Together with $\\sqrt{1 - 2\\delta} \\leq F_1$, this yields $\\delta \\geq \\delta_{\\text{far}} = \\frac{1}{2}[1 - (1 - \\varepsilon_2^2)^{1/n}]$. Any simpler rule like ‚Äúreject if $F_n \\leq \\tau$‚Äù with $\\tau \u003c \\sqrt{1 - \\varepsilon_2^2}$ will falsely accept some far states. Example: $\\varepsilon_2 = 0.8 \\implies \\sqrt{1 - \\varepsilon_2^2} = 0.6$; a state with $F_n = 0.55$ has $D_n = \\sqrt{1 - 0.55^2} \\approx 0.835 \u003e \\varepsilon_2$ yet would be accepted by $\\tau = 0.4$.\nWhat about completeness? We will soon see that the proof for completeness (avoiding false rejects of close states) is not a deterministic guarantee, but a statistical one. It‚Äôs the promise that if you are given a good state, your experiment will correctly identify it with very high confidence $1 - \\alpha$. This guarantee comes from the power of the Chernoff-Hoeffding concentration bound, and we will see the full reasoning below.\nRemark. You might notice that this explicit discussion of sufficient and necessary conditions was not needed for the single-copy test. This is because the single-copy proof is more direct - in that case, the Asymptotic EPR Identity Bound ($\\delta \\geq \\varepsilon^2/2$) provides a single, powerful, and symmetric link between the trace distance $\\varepsilon$ and the error rate $\\delta$, without needing to use fidelity as an intermediary, so it implicitly contains both the necessary and sufficient logic needed to construct the test. In contrast, the multi-copy proof uses the asymmetric Fuchs-van de Graaf inequalities, forcing us to explicitly analyse the logical direction for each guarantee.\nLet‚Äôs quickly verify that $F_n^2 \\geq 1 - \\varepsilon_1^2$ is a sufficient condition for $D_n \\leq \\varepsilon_1$ ($\\mathbf{H_0}$): $$ F_n^2 \\geq 1 - \\varepsilon_1^2 \\quad\\iff\\quad 1 - F_n^2 \\leq \\varepsilon_1^2 $$ by rearranging. Substituting this into the upper bound of Fuchs‚Äìvan de Graaf yields $$ D_n ~\\leq~ \\sqrt{1 - F_n^2} ~\\leq~ \\sqrt{\\varepsilon_1^2} ~=~ \\varepsilon_1 $$ so indeed $[F_n^2 \\geq 1 - \\varepsilon_1^2] \\implies [D_n \\leq \\varepsilon_1]$. Similarly we can verify that $F_n^2 \\leq 1 - \\varepsilon_2^2$ is a necessary condition for $D_n \\geq \\varepsilon_2$ ($\\mathbf{H_1}$) by plugging $\\mathbf{H_1}$ into the upper bound of Fuchs‚Äìvan de Graaf: $$ \\varepsilon_2 \\leq D_n \\quad\\implies\\quad \\varepsilon_2 ~\\leq~ D_n ~\\leq~ \\sqrt{1 - F_n^2}. $$ Rearranging $$ \\varepsilon_2 \\leq \\sqrt{1 - F_n^2} \\quad\\iff\\quad F_n^2 \\leq 1 - \\varepsilon_2^2 $$ immediately shows that $[D_n \\geq \\varepsilon_2] \\implies [F_n^2 \\leq 1 - \\varepsilon_2^2]$ as required.\nDefining the error rate thresholds The link between fidelity $F_1$ and true error rate $\\delta$ from the single-copy asymptotic bound analysis is $$ F_1 \\geq \\sqrt{1 - 2\\delta} \\quad\\iff\\quad \\delta \\geq \\frac{1 - F_1^2}{2}. $$ We will use this relation to define thresholds on $\\delta$.\nConvention. For each basis, we relabel Bob‚Äôs outcomes if needed so the mismatch rate is $\\leq 1/2$ (i.e., replace $\\delta_b$ by $\\min \\{\\delta_b, 1 - \\delta_b\\}$). With this standard symmetrisation, the aggregated $\\delta \\in [0, 1/2]$ and the bound $F_1 \\geq \\sqrt{1-2\\delta}$ is always meaningful.\nConcretely, let $$ f(\\varepsilon) := \\frac{1 - (1 - \\varepsilon^2)^{1/n}}{2}, $$ and $$ \\qquad \\delta_{\\text{close}} := \\frac{1 - (1 - \\varepsilon_1^2)^{1/n}}{2} = f(\\varepsilon_1), \\qquad \\delta_{\\text{far}} := \\frac{1 - (1 - \\varepsilon_2^2)^{1/n}}{2} = f(\\varepsilon_2). $$These choices are justified as follows:\n(Close) If $\\delta \\leq \\delta_{\\text{close}}$, then $F_1 \\geq \\sqrt{1 - 2\\delta} \\geq \\sqrt{1-2\\delta_{\\text{close}}}$, hence $$ F_n \\geq (1 - 2\\delta_{\\text{close}})^{n/2} = \\sqrt{1 - \\varepsilon_1^{2}}, $$ so from above $D_n \\leq \\varepsilon_1$.\n(Far) If $D_n \\geq \\varepsilon_2$, then $F_n \\leq \\sqrt{1 - \\varepsilon_2^{2}}$, i.e. $F_1 \\leq (1 - \\varepsilon_2^{2})^{1/(2n)}$. Combining with $\\sqrt{1 - 2\\delta} \\leq F_1$ forces $$ 1 - 2\\delta \\leq (1 - \\varepsilon_2^{2})^{1/n} \\quad\\implies\\quad \\delta \\geq \\delta_{\\text{far}}. $$ Bounding the promise gap The promise gap in $\\delta$ is $$ \\Delta_{\\delta} ~=~ \\delta_{\\text{far}} - \\delta_{\\text{close}} ~=~ f(\\varepsilon_2) - f(\\varepsilon_1). $$ To get a lower bound on the promise gap, we first note that $$ f(\\varepsilon) = \\frac{1 - (1 - \\varepsilon^2)^{1/n}}{2} $$ is continuous on $[0, 1]$ for any $n \\geq 2$; we only consider $n \\geq 2$ since $n$ is the number of EPR pairs and so $n = 1$ reduces to the single-copy test. Indeed, $f$ is built by composing several maps on $[0, 1]$:\n$\\varepsilon \\mapsto \\varepsilon^2$ (continuous), $x \\mapsto 1 - x$ (continuous), $y \\mapsto y^{1/n}$ (continuous for $y \\geq 0$). Each of these components is continuous on the domain $[0, 1]$. Hence their composition, $f$, is also continuous on the closed interval $[0, 1]$. By the fundamental theorem of calculus, $$ \\Delta_\\delta = f(\\varepsilon_2)-f(\\varepsilon_1) = \\int_{\\varepsilon_1}^{\\varepsilon_2} f'(\\varepsilon)\\,d\\varepsilon. $$ For $n\\ge2$, differentiating $f(\\varepsilon)$ gives $$ f'(\\varepsilon) = \\frac{\\varepsilon}{n}(1 - \\varepsilon^2)^{\\frac{1}{n} - 1}. $$ Since $0 \\leq \\varepsilon \u003c 1$ implies $1 - \\varepsilon^2 \\in (0, 1]$ and $\\frac{1}{n} - 1 \\leq 0$ as $n \\geq 2$, we have $$ (1 - \\varepsilon^2)^{\\frac{1}{n} - 1} \\geq 1 \\qquad\\left[\\,\\forall \\varepsilon \\in [0, 1)\\,\\right]. $$ Multiplying through by $\\varepsilon/n$ we get $$ f'(\\varepsilon) \\geq \\frac{\\varepsilon}{n}. $$ Therefore, $$ \\Delta_\\delta = \\int_{\\varepsilon_1}^{\\varepsilon_2} f'(\\varepsilon)\\,d\\varepsilon ~\\geq~ \\int_{\\varepsilon_1}^{\\varepsilon_2}\\frac{\\varepsilon}{n}\\,d\\varepsilon =\\frac{\\varepsilon_2^2 - \\varepsilon_1^2}{2n}. $$Taking $\\varepsilon_2\\to 1^{-}$ (and using continuity of $f$) shows the same bound holds when $\\varepsilon_2 = 1$. Hence, for all $0 \\leq \\varepsilon_1 \u003c \\varepsilon_2 \\leq 1$, $$ \\Delta_\\delta \\geq \\frac{\\varepsilon_2^2 - \\varepsilon_1^2}{2n}. $$ Note. At $\\varepsilon=1$, the factor $(1 - \\varepsilon^2)^{\\frac{1}{n} - 1}$ diverges (for $n \u003e 2$), which only strengthens $(1 - \\varepsilon^2)^{\\frac{1}{n} - 1} \\geq 1$ and $f'(\\varepsilon) \\geq \\varepsilon/n$. The integral is interpreted as a limit from below when the upper limit is $1$.\nDecision rule and sample complexity Define a margin $$ t := \\frac{\\Delta_{\\delta}}{2} = \\frac{\\delta_{\\text{far}} - \\delta_{\\text{close}}}{2}. $$ Pick a single cutoff inside the gap (the midpoint): $$ c := \\frac{\\delta_{\\text{close}} + \\delta_{\\text{far}}}{2} = \\frac{f(\\varepsilon_1) + f(\\varepsilon_2)}{2}. $$ After running the protocol and computing the empirical mismatch rate $\\hat\\delta$ on the matching‚Äëbasis rounds $S$, we define the decision rule as $$ \\text{Decision} = \\begin{cases} \\text{‚Äúclose‚Äù} \u0026 \\text{if } \\hat\\delta \\leq c,\\\\ \\text{‚Äúfar‚Äù} \u0026 \\text{if } \\hat\\delta \u003e c. \\end{cases} $$ On matching‚Äëbasis rounds, the indicators $\\{ Y_i \\}_{i \\in S}$ are i.i.d. Bernoulli random variables with mean $\\delta$. Chernoff‚ÄìHoeffding gives, for any $t \u003e 0$, $$ \\Pr\\!\\left[|\\hat\\delta - \\delta| \\geq t\\right] \\leq 2e^{-2|S|t^2}. $$ Completeness ($\\delta \\leq \\delta_{\\text{close}}$): If the good event $|\\hat\\delta - \\delta| \u003c t$ holds, then $\\hat\\delta \\leq \\delta_{\\text{close}} + t = c \\Rightarrow$ accept.\nSoundness ($\\delta \\geq \\delta_{\\text{far}}$): If $|\\hat\\delta-\\delta| \u003c t$, then $\\hat\\delta \u003e \\delta_{\\text{far}} - t = c \\Rightarrow$ reject.\nTherefore, each error (completeness or soundness) occurs only if $|\\hat\\delta-\\delta|\\geq t$ (the bad event). To make this probability $\\leq \\alpha$, it suffices that $$ 2e^{-2|S|t^2} \\leq \\alpha \\quad\\iff\\quad |S| \\geq \\frac{2}{\\Delta_\\delta^{2}}\\,\\ln\\!\\frac{2}{\\alpha} \\qquad (t = \\Delta_\\delta/2). $$ The bound on $\\Delta_\\delta$ from the integral earlier states that $$ \\Delta_\\delta \\geq \\frac{\\varepsilon_2^2 - \\varepsilon_1^2}{2n}. $$ From this, we can derive that $$ \\begin{aligned} \\Delta_\\delta ~\\geq~ \\frac{\\varepsilon_2^2 - \\varepsilon_1^2}{2n} \u0026{\\quad\\iff\\quad} \\Delta_\\delta^2 ~\\geq~ \\left(\\frac{\\varepsilon_2^2 - \\varepsilon_1^2}{2n}\\right)^2 \\\\[10pt]\u0026{\\quad\\iff\\quad} \\Delta_\\delta^2 ~\\geq~ \\frac{\\left(\\varepsilon_2^2 - \\varepsilon_1^2\\right)^2}{4n^2} \\\\[10pt]\u0026{\\quad\\iff\\quad} \\frac{1}{\\Delta_\\delta^2} ~\\leq~ \\frac{4n^2}{\\left(\\varepsilon_2^2 - \\varepsilon_1^2\\right)^2} \\\\[15pt]\u0026{\\quad\\iff\\quad} \\frac{2}{\\Delta_\\delta^2} \\ln \\frac{2}{\\alpha} ~\\leq~ \\frac{8n^2}{\\left( \\varepsilon_2^2 - \\varepsilon_1^2 \\right)^2} \\ln \\frac{2}{\\alpha} \\quad[\\,=: L\\,]. \\end{aligned} $$ Since $\\Delta_\\delta \\geq (\\varepsilon_2^2 - \\varepsilon_1^2)/(2n)$ and $\\frac{2}{\\Delta_\\delta^2}\\,\\ln\\!\\frac{2}{\\alpha}$ is strictly decreasing in $\\Delta_\\delta$, the true requirement is always at most $L$. Therefore, choosing $|S| \\geq L$ guarantees the condition is satisfied for all admissible $\\Delta_\\delta$: $$ |S| \\geq \\underbrace{\\frac{8\\,n^2}{\\left( \\varepsilon_2^2 - \\varepsilon_1^2 \\right)^2}\\,\\ln\\!\\frac{2}{\\alpha}}_{\\text{Our choice (worst-case }L\\text{)}} \\quad\\geq\\quad \\underbrace{\\frac{2}{\\Delta_\\delta^{2}}\\,\\ln\\!\\frac{2}{\\alpha}}_{\\text{What we actually need}}. $$ In other words, a sufficient condition for $|S|$ is: $$ |S| ~\\geq~ \\frac{8\\,n^2}{\\left( \\varepsilon_2^2 - \\varepsilon_1^2 \\right)^2}\\,\\ln\\!\\frac{2}{\\alpha}. $$ As before, only about half of the $N$ rounds are matching-basis. Taking $N = 4|S|$ (by the same argument from the single-copy case), $$ N ~\\geq~ \\frac{32\\,n^2}{\\left( \\varepsilon_2^2 - \\varepsilon_1^2 \\right)^2}\\,\\ln\\!\\frac{2}{\\alpha} \\qquad\\left[= O\\left(n^2\\left(\\varepsilon_2^2 - \\varepsilon_1^2\\right)^{-2}\\right)\\right]. $$So it turns out that extending the test from a single copy to $n$ i.i.d. copies is not free: the price is a quadratic blow-up in sample complexity, which is intuitive and expected when you consider the difference in the guarantees. Certifying that the entire collection of $n$ states is globally $\\varepsilon$-close is a much stricter requirement than certifying a single state. This is because a tiny imperfection in each copy, when compounded over the tensor product of all $n$ states, can result in a large global deviation. To compensate for this, the required fidelity of each copy must be much higher. This in turn forces the promise gap $\\Delta_\\delta$ for the true error rate $\\delta$ to become approximately $n$ times narrower, squeezing the thresholds for ‚Äúclose‚Äù and ‚Äúfar‚Äù states into a much smaller window near zero.\nThe reason for this is that our promise is about the global state of all $n$ copies. For the global state to be nearly perfect (i.e., have a high global fidelity $F_n = F_1^n$), the fidelity of each single copy ($F_1$) must be extremely close to $1$. Since the true error rate $\\delta$ is a direct measure of the imperfection in a single copy, this extremely high fidelity requirement forces $\\delta$ to be (comparatively) much smaller than it would be in the single-copy test. As a result, this effectively ‚Äúsqueezes‚Äù the entire range of relevant error rates into a tiny window near zero, which makes the absolute gap between our $\\delta_{\\text{close}}$ and $\\delta_{\\text{far}}$ thresholds narrower.\nA core principle of statistics is that the uncertainty of an estimated average is proportional to the inverse square root of the number of samples (in our case, this is $1 / \\sqrt{|S|}$). To reliably measure a promise gap that is $n$ times smaller, our estimate for $\\Delta_\\delta$ must be $n$ times more precise. Achieving this $n$-fold increase in precision requires an $n^2$-fold increase in the number of samples, which leads directly to the $O(n^2)$ scaling in complexity we‚Äôre seeing. Putting everything together succinctly:\nTheorem (Finite-sample tolerant EPR identity test, i.i.d. product version).\nLet $n \\geq 2$ be the number of i.i.d. copies of $\\rho_{AB}$ held by Alice and Bob. For brevity, write $$ \\rho = \\rho_{AB},\\qquad \\Phi=\\ket{\\mathrm{EPR}}\\bra{\\mathrm{EPR}}_{AB}. $$ Fix global trace-distance tolerances $0 \\leq \\varepsilon_1 \u003c \\varepsilon_2 \\leq 1$ and confidence $1 - \\alpha$. Define $$ \\begin{aligned} \u0026f(\\varepsilon) = \\frac{1}{2}\\!\\left[1 - (1 - \\varepsilon^2)^{1/n}\\right]\u0026,\u0026 \u0026\\delta_{\\text{close}} = f(\\varepsilon_1), \\\\[10pt]\u0026\\delta_{\\text{far}} = f(\\varepsilon_2)\u0026,\u0026 \\qquad \u0026c = \\frac{\\delta_{\\text{close}} + \\delta_{\\text{far}}}{2}. \\end{aligned} $$ Run the matching-outcomes protocol for $$ N ~\\geq~ \\frac{32\\,n^2}{\\left( \\varepsilon_2^2 - \\varepsilon_1^2 \\right)^2}\\,\\ln\\!\\frac{2}{\\alpha} \\qquad\\left[= O\\left(n^2\\left(\\varepsilon_2^2 - \\varepsilon_1^2\\right)^{-2}\\right)\\right] $$ rounds, and accept if and only if the observed error $\\hat{\\delta} \\leq c$. Then:\nIf $D(\\rho^{\\otimes n},\\Phi^{\\otimes n}) \\leq \\varepsilon_1$, the test accepts with probability $\\geq 1 - \\alpha$. If $D(\\rho^{\\otimes n},\\Phi^{\\otimes n}) \\geq \\varepsilon_2$, the test rejects with probability $\\geq 1 - \\alpha$. If $\\varepsilon_1 \u003c D(\\rho^{\\otimes n},\\Phi^{\\otimes n}) \u003c \\varepsilon_2$, no guarantee is provided; the test may accept or reject. That completes the ‚Äúeasy‚Äù i.i.d. case. Next, we‚Äôll remove the identical-copy assumption.\nMedium case (independent, non-identical copies) copy from obsidian todo: maybe now we can use the same sufficiency/necessity argument and we can finish off the closeness part of the medium case\n","wordCount":"2901","inLanguage":"en","datePublished":"2025-08-08T17:42:31+01:00","dateModified":"2025-08-08T17:42:31+01:00","author":{"@type":"Person","name":"Howard Cheung"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://teaegg.net/research/urss/n-epr-test/"},"publisher":{"@type":"Organization","name":"ùóßùóòùóî‚Ä¢ùóòùóöùóö","logo":{"@type":"ImageObject","url":"https://teaegg.net/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://teaegg.net/ title=Home>ùóßùóòùóî‚Ä¢ùóòùóöùóö</a><div class=logo-switches><button id=theme-toggle title="Toggle theme" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://teaegg.net/aboutme/ title="About Me"><span>About Me</span></a></li><li><a href=https://teaegg.net/journal/ title=Journal><span>Journal</span></a></li><li><a href=https://teaegg.net/research/ title=Research><span>Research</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://teaegg.net/>üè† Home</a>&nbsp;¬ª&nbsp;<a href=https://teaegg.net/research/>üî¨ Research</a>&nbsp;¬ª&nbsp;<a href=https://teaegg.net/research/urss/>üîêüí° Undergraduate Research Support Scheme (URSS)</a></div><h1 class="post-title entry-hint-parent">Classical tolerant identity test for multiple EPR states</h1><div class=post-meta><span title='2025-08-08 17:42:31 +0100 +0100'>August 8, 2025</span>&nbsp;¬∑&nbsp;14 min&nbsp;¬∑&nbsp;Howard Cheung</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#easy-case-iid-copies aria-label="Easy case (i.i.d. copies)">Easy case (i.i.d. copies)</a><ul><li><a href=#a-na%c3%afve-per-copy-approach-using-trace-distance aria-label="A na√Øve per-copy approach using trace distance">A na√Øve per-copy approach using trace distance</a></li><li><a href=#global-block-test-using-fidelity aria-label="Global block test using fidelity">Global block test using fidelity</a><ul><li><a href=#translating-hypotheses aria-label="Translating hypotheses">Translating hypotheses</a></li><li><a href=#defining-the-error-rate-thresholds aria-label="Defining the error rate thresholds">Defining the error rate thresholds</a></li><li><a href=#bounding-the-promise-gap aria-label="Bounding the promise gap">Bounding the promise gap</a></li><li><a href=#decision-rule-and-sample-complexity aria-label="Decision rule and sample complexity">Decision rule and sample complexity</a></li></ul></li></ul></li><li><a href=#medium-case-independent-non-identical-copies aria-label="Medium case (independent, non-identical copies)">Medium case (independent, non-identical copies)</a></li></ul></div></details></div><div class=post-content><p>With the <a href=../epr-tolerant-identity-testing>tolerant identity test</a> for a single state $\rho_{AB}$ complete, we now turn to the problem of certifying multiple EPR pairs. For brevity we write</p>$$
\rho = \rho_{AB},
\qquad
\Phi = \ket{\text{EPR}}\bra{\text{EPR}}_{AB}.
$$<p>In particular, we will show how the same matching-outcomes protocol extends in three settings of increasing generality and difficulty:</p><ol><li><p><strong>Easy (i.i.d. copies).</strong></p><p>All $n$ copies are identical:</p>$$
\rho^{\otimes n}\quad\text{vs.}\quad\Phi^{\otimes n}.
$$</li><li><p><strong>Medium (independent, non-identical copies).</strong></p><p>Each copy may differ but remains uncorrelated:</p>$$
\rho_1\otimes\rho_2\otimes\dots\otimes\rho_n
\quad\text{vs.}\quad
\Phi^{\otimes n}.
$$</li><li><p><strong>Hard (arbitrary adversary).</strong></p><p>The most general case allows an arbitrary $2n$-qubit state $\rho$, possibly entangled across copies, against which we still wish to test closeness to $\Phi^{\otimes n}$.</p></li></ol><p>We will analyse the number of protocol rounds, $N$, required to certify $n$ EPR pairs.</p><p>Can we achieve the same sample complexity</p>$$
N = O\!\left(n^2\,(\varepsilon_2^2 - \varepsilon_1^2)^{-2}\right)\!.
$$<p>in all three cases?</p><blockquote><p><strong>Note.</strong> In the context of BB'84, these three scenarios correspond directly to the class of attacks that an eavesdropper (Eve) might do:</p><ul><li><p><strong>Easy (i.i.d. copies)</strong>:
Eve applies the same attack channel to each transmitted qubit independently, with no memory from one round to the next. Every round she starts from scratch, so her joint state is $\rho^{\otimes n}$.</p></li><li><p><strong>Medium (independent, non-identical copies)</strong>:
Eve still treats each qubit independently and measures immediately, but she may choose a different attack in each round. Her overall state is the product $\rho_{1}\otimes\rho_{2}\otimes\dots\otimes\rho_{n}$.</p></li><li><p><strong>Hard (arbitrary adversary)</strong>:
Eve may entangle her systems across rounds and defer all measurements until the end. There is no tensor-product structure, so her state is an arbitrary $2n$-qubit $\rho$.</p></li></ul><p>By proving security in each model, starting with the easiest and working up to the fully coherent setting, we obtain a hierarchy of BB'84 security guarantees that mirror the increasing power of potential attack by Eve. <del>From the sample complexity, we will see that a fully coherent attack (hard case) isn&rsquo;t more difficult to detect than a simple i.i.d. tensor product state (easy case)!</del> <code>&lt;- not sure about this yet</code></p></blockquote><p>We begin with the i.i.d. case as it&rsquo;s both the simplest to analyse and a useful building block for the more challenging scenarios.</p><hr><h2 id=easy-case-iid-copies>Easy case (i.i.d. copies)<a hidden class=anchor aria-hidden=true href=#easy-case-iid-copies>#</a></h2><h3 id=a-na√Øve-per-copy-approach-using-trace-distance>A na√Øve per-copy approach using trace distance<a hidden class=anchor aria-hidden=true href=#a-na√Øve-per-copy-approach-using-trace-distance>#</a></h3><p>A first idea is to ignore the joint state altogether and simply run the <strong>single-pair</strong> tolerant test on each of the $n$ copies <strong>separately</strong>, then accept only if every individual test passes. Equivalently, one could tally the per-copy mismatch indicators into a total error count and compare that sum against a scaled threshold (thanks to the i.i.d. assumption). At first glance this seems painless, but a closer look shows it is actually <em>worse</em> than the collective strategy developed below.</p><p>Recall for a single copy $\rho$:</p>$$
D_1 ~=~ D(\rho,\Phi),
$$<p>and in the $n$-copy i.i.d. case we have the bound</p>$$
D_n ~:=~ D\bigl(\rho^{\otimes n},\,\Phi^{\otimes n}\bigr) ~\leq~ n\,D_1.
$$<ul><li><strong>Per-copy tolerance must shrink.</strong>
To guarantee that the full product state satisfies $D(\rho^{\otimes n},\Phi^{\otimes n}) \leq \varepsilon_1$, the trace-distance of <em>each</em> copy must be at most $\varepsilon_1/n$; otherwise the sub-additivity bound $D_n\leq nD_1$ could exceed $\varepsilon_1$.</li><li><strong>Promise gap narrows by a factor $n$.</strong>
Replacing $\varepsilon_j$ by $\varepsilon_j/n$ shrinks the gap $\varepsilon_2^2 - \varepsilon_1^2$ by $n^{2}$. For the single-pair test the sample size scales as the inverse square of that gap, so one copy now needs
$$
O\bigl(n^{4}(\varepsilon_2^2-\varepsilon_1^2)^{-2}\bigr)
$$
samples.</li><li><strong>Replicated testing scales linearly.</strong>
Running $n$ such tests and combining them multiplies the sample cost by $n$.</li></ul><p>Hence by a very high-level analysis, we obtain a cost for the na√Øve strategy</p>$$
N_{\text{na√Øve}} ~=~ O\bigl(n^{5}(\varepsilon_2^2-\varepsilon_1^2)^{-2}\bigr),
$$<p>which is three full powers of $n$ ($n^{5}$ vs. $n^{2}$) worse than the collective $n$-copy analysis we develop below. The lesson is that testing each pair in isolation achieves a <em>stronger</em> (per-copy) guarantee than we need and pays a steep statistical price; exploiting the product structure directly using just one global test is markedly more efficient.</p><hr><h3 id=global-block-test-using-fidelity>Global block test using fidelity<a hidden class=anchor aria-hidden=true href=#global-block-test-using-fidelity>#</a></h3><p>For a single copy $\rho$:</p>$$
F_1 ~=~ F(\rho,\Phi),
\quad
D_1 ~=~ D(\rho,\Phi),
$$<p>and in the $n$-copy i.i.d. case we have the rules</p>$$
F_n ~:=~ F\bigl(\rho^{\otimes n},\,\Phi^{\otimes n}\bigr) ~=~ F_1^{n},
\qquad
D_n ~:=~ D\bigl(\rho^{\otimes n},\,\Phi^{\otimes n}\bigr) ~\leq~ n\,D_1.
$$<p>This means we can express the $n$-copy closeness conditions entirely in terms of the single-copy fidelity $F_1$, thanks to the exact tensor-product rule $F(\rho^{\otimes n},\Phi^{\otimes n}) = F(\rho,\Phi)^n$ (or equivalently $F_n = F_1^n$). Working directly with fidelity avoids the looser trace-distance bound $D(\rho^{\otimes n},\Phi^{\otimes n}) \leq n\,D(\rho,\Phi)$, which would give a much weaker bound than the tight scaling we get from fidelity.</p><h4 id=translating-hypotheses>Translating hypotheses<a hidden class=anchor aria-hidden=true href=#translating-hypotheses>#</a></h4><p>Our goal is to distinguish</p>$$
\begin{cases}
~\mathbf{H_0}: &D_n \,\leq\,\varepsilon_1
\quad\iff\quad \rho^{\otimes n}\text{ is ‚Äúclose‚Äù to }\Phi^{\otimes n},\\[6pt]
~\mathbf{H_1}: &D_n \,\geq\,\varepsilon_2
\quad\iff\quad \rho^{\otimes n}\text{ is ‚Äúfar‚Äù from }\Phi^{\otimes n},
\end{cases}
$$<p>with $0 \leq \varepsilon_1 < \varepsilon_2 \leq 1$. By Fuchs‚Äìvan de Graaf,</p>$$
1 - F_n ~\leq~ D_n ~\leq~ \sqrt{1 - F_n^{2}},
$$<p>so controlling $F_n$ tightly leads to a corresponding control on $D_n$. Since $F_n = F_1^{n}$, we can use this and the upper bound of Fuchs‚Äìvan de Graaf to rewrite the hypotheses as fidelity conditions per-copy:</p>$$
\begin{cases}
~\mathbf{H_0}: \quad &D_n \,\leq\,\varepsilon_1 &\impliedby &F_n^2 ~\geq~ 1 - \varepsilon_1^2
&\iff
&F_1 ~\geq~ (1 - \varepsilon_1^2)^{1/(2n)}
\\[4pt]
~\mathbf{H_1}: \quad &D_n \,\geq\,\varepsilon_2 &\implies &F_n^2 ~\leq~ 1 - \varepsilon_2^2
&\iff
&F_1 ~\leq~ (1 - \varepsilon_2^2)^{1/(2n)}
\end{cases}\quad.
$$<p>You might be wondering why we need a <u>sufficient</u> condition for $\mathbf{H_0}$ and a <u>necessary</u> condition for $\mathbf{H_1}$. This is because we need to guarantee that accepted states are truly close (requiring a sufficient condition) and that far states are rejected (requiring a necessary condition) to prevent <strong>false accepts</strong>.</p><ul><li><p><strong>Soundness of acceptance (Accept $\Rightarrow$ Close; avoid false accepts).</strong>
Why do we use a &ldquo;sufficient&rdquo; $F\!\to\!D$ direction? We want &ldquo;if the test accepts, the global state is close&rdquo;, i.e. no false accept. That needs an <em>upper</em> bound on distance from fidelity, which comes from the <em>right-hand</em> FvG:</p>$$
D_n \leq \sqrt{1 - F_n^2}.
$$<p>So we enforce $F_n \geq \sqrt{1 - \varepsilon_1^2}$ (equivalently $F_1 \geq (1 - \varepsilon_1^2)^{1/(2n)}$), which <em>forces</em> $D_n \leq \varepsilon_1$.
If instead you used the left-hand side $1 - F_n \leq D_n$ with a threshold $F_n \geq 1-\varepsilon_1$, you could falsely accept a far state. Example: take $\varepsilon_1 = 0.1$ and a state with $F_n = 0.90$. The right-hand FvG still allows $D_n$ to be as high as $\sqrt{1 - 0.9^2} \approx 0.436 > 0.1$, so the state could be far from the target yet would be accepted by this flawed rule.</p></li><li><p><strong>Soundness of rejection (Far $\Rightarrow$ Reject; again avoid false accepts).</strong>
Why do we use a &ldquo;necessary&rdquo; $D\!\to\!F$ direction? We want every far state to be rejected, i.e. no false accept. We start from &ldquo;far $\Rightarrow$ small fidelity&rdquo;, and again consider the <em>right-hand</em> FvG:</p>$$
D_n \geq \varepsilon_2 \implies F_n \leq \sqrt{1 - \varepsilon_2^2}.
$$<p>Together with $\sqrt{1 - 2\delta} \leq F_1$, this yields $\delta \geq \delta_{\text{far}} = \frac{1}{2}[1 - (1 - \varepsilon_2^2)^{1/n}]$. Any simpler rule like &ldquo;reject if $F_n \leq \tau$&rdquo; with $\tau < \sqrt{1 - \varepsilon_2^2}$ will falsely accept some far states. Example: $\varepsilon_2 = 0.8 \implies \sqrt{1 - \varepsilon_2^2} = 0.6$; a state with $F_n = 0.55$ has $D_n = \sqrt{1 - 0.55^2} \approx 0.835 > \varepsilon_2$ yet would be accepted by $\tau = 0.4$.</p></li></ul><p><strong>What about completeness?</strong>
We will soon see that the proof for completeness (avoiding <strong>false rejects</strong> of close states) is not a <em>deterministic</em> guarantee, but a <em>statistical</em> one. It&rsquo;s the promise that if you are given a good state, your experiment will correctly identify it with very high confidence $1 - \alpha$. This guarantee comes from the power of the Chernoff-Hoeffding concentration bound, and we will see the full reasoning below.</p><blockquote><p><strong>Remark.</strong> You might notice that this explicit discussion of sufficient and necessary conditions was not needed for the single-copy test. This is because the single-copy proof is more direct - in that case, the Asymptotic EPR Identity Bound ($\delta \geq \varepsilon^2/2$) provides a single, powerful, and symmetric link between the trace distance $\varepsilon$ and the error rate $\delta$, without needing to use fidelity as an intermediary, so it implicitly contains both the necessary and sufficient logic needed to construct the test. In contrast, the multi-copy proof uses the asymmetric Fuchs-van de Graaf inequalities, forcing us to explicitly analyse the logical direction for each guarantee.</p></blockquote><p>Let&rsquo;s quickly verify that $F_n^2 \geq 1 - \varepsilon_1^2$ is a sufficient condition for $D_n \leq \varepsilon_1$ ($\mathbf{H_0}$):</p>$$
F_n^2 \geq 1 - \varepsilon_1^2 \quad\iff\quad 1 - F_n^2 \leq \varepsilon_1^2
$$<p>by rearranging. Substituting this into the upper bound of Fuchs‚Äìvan de Graaf yields</p>$$
D_n ~\leq~ \sqrt{1 - F_n^2} ~\leq~ \sqrt{\varepsilon_1^2} ~=~ \varepsilon_1
$$<p>so indeed $[F_n^2 \geq 1 - \varepsilon_1^2] \implies [D_n \leq \varepsilon_1]$. Similarly we can verify that $F_n^2 \leq 1 - \varepsilon_2^2$ is a necessary condition for $D_n \geq \varepsilon_2$ ($\mathbf{H_1}$) by plugging $\mathbf{H_1}$ into the upper bound of Fuchs‚Äìvan de Graaf:</p>$$
\varepsilon_2 \leq D_n \quad\implies\quad \varepsilon_2 ~\leq~ D_n ~\leq~ \sqrt{1 - F_n^2}.
$$<p>Rearranging</p>$$
\varepsilon_2 \leq \sqrt{1 - F_n^2} \quad\iff\quad F_n^2 \leq 1 - \varepsilon_2^2
$$<p>immediately shows that $[D_n \geq \varepsilon_2] \implies [F_n^2 \leq 1 - \varepsilon_2^2]$ as required.</p><h4 id=defining-the-error-rate-thresholds>Defining the error rate thresholds<a hidden class=anchor aria-hidden=true href=#defining-the-error-rate-thresholds>#</a></h4><p>The link between fidelity $F_1$ and true error rate $\delta$ from the single-copy asymptotic bound analysis is</p>$$
F_1 \geq \sqrt{1 - 2\delta} \quad\iff\quad \delta \geq \frac{1 - F_1^2}{2}.
$$<p>We will use this relation to define thresholds on $\delta$.</p><blockquote><p><strong>Convention.</strong> For each basis, we relabel Bob&rsquo;s outcomes if needed so the mismatch rate is $\leq 1/2$ (i.e., replace $\delta_b$ by $\min \{\delta_b, 1 - \delta_b\}$). With this standard symmetrisation, the aggregated $\delta \in [0, 1/2]$ and the bound $F_1 \geq \sqrt{1-2\delta}$ is always meaningful.</p></blockquote><p>Concretely, let</p>$$
f(\varepsilon) := \frac{1 - (1 - \varepsilon^2)^{1/n}}{2},
$$<p>and</p>$$
\qquad \delta_{\text{close}} := \frac{1 - (1 - \varepsilon_1^2)^{1/n}}{2} = f(\varepsilon_1),
\qquad \delta_{\text{far}} := \frac{1 - (1 - \varepsilon_2^2)^{1/n}}{2} = f(\varepsilon_2).
$$<p>These choices are justified as follows:</p><ul><li><p>(<strong>Close</strong>) If $\delta \leq \delta_{\text{close}}$, then $F_1 \geq \sqrt{1 - 2\delta} \geq \sqrt{1-2\delta_{\text{close}}}$, hence</p>$$
F_n \geq (1 - 2\delta_{\text{close}})^{n/2} = \sqrt{1 - \varepsilon_1^{2}},
$$<p>so from above $D_n \leq \varepsilon_1$.</p></li><li><p>(<strong>Far</strong>) If $D_n \geq \varepsilon_2$, then $F_n \leq \sqrt{1 - \varepsilon_2^{2}}$, i.e. $F_1 \leq (1 - \varepsilon_2^{2})^{1/(2n)}$. Combining with $\sqrt{1 - 2\delta} \leq F_1$ forces</p>$$
1 - 2\delta \leq (1 - \varepsilon_2^{2})^{1/n} \quad\implies\quad \delta \geq \delta_{\text{far}}.
$$</li></ul><h4 id=bounding-the-promise-gap>Bounding the promise gap<a hidden class=anchor aria-hidden=true href=#bounding-the-promise-gap>#</a></h4><p>The promise gap in $\delta$ is</p>$$
\Delta_{\delta} ~=~ \delta_{\text{far}} - \delta_{\text{close}} ~=~ f(\varepsilon_2) - f(\varepsilon_1).
$$<p>To get a lower bound on the promise gap, we first note that</p>$$
f(\varepsilon) = \frac{1 - (1 - \varepsilon^2)^{1/n}}{2}
$$<p>is continuous on $[0, 1]$ for any $n \geq 2$; we only consider $n \geq 2$ since $n$ is the number of EPR pairs and so $n = 1$ reduces to the single-copy test. Indeed, $f$ is built by composing several maps on $[0, 1]$:</p><ul><li>$\varepsilon \mapsto \varepsilon^2$ (continuous),</li><li>$x \mapsto 1 - x$ (continuous),</li><li>$y \mapsto y^{1/n}$ (continuous for $y \geq 0$).
Each of these components is continuous on the domain $[0, 1]$. Hence their composition, $f$, is also continuous on the closed interval $[0, 1]$.</li></ul><p>By the fundamental theorem of calculus,</p>$$
\Delta_\delta
= f(\varepsilon_2)-f(\varepsilon_1)
= \int_{\varepsilon_1}^{\varepsilon_2} f'(\varepsilon)\,d\varepsilon.
$$<p>For $n\ge2$, differentiating $f(\varepsilon)$ gives</p>$$
f'(\varepsilon) = \frac{\varepsilon}{n}(1 - \varepsilon^2)^{\frac{1}{n} - 1}.
$$<p>Since $0 \leq \varepsilon < 1$ implies $1 - \varepsilon^2 \in (0, 1]$ and $\frac{1}{n} - 1 \leq 0$ as $n \geq 2$, we have</p>$$
(1 - \varepsilon^2)^{\frac{1}{n} - 1} \geq 1 \qquad\left[\,\forall \varepsilon \in [0, 1)\,\right].
$$<p>Multiplying through by $\varepsilon/n$ we get</p>$$
f'(\varepsilon) \geq \frac{\varepsilon}{n}.
$$<p>Therefore,</p>$$
\Delta_\delta = \int_{\varepsilon_1}^{\varepsilon_2} f'(\varepsilon)\,d\varepsilon
~\geq~ \int_{\varepsilon_1}^{\varepsilon_2}\frac{\varepsilon}{n}\,d\varepsilon
=\frac{\varepsilon_2^2 - \varepsilon_1^2}{2n}.
$$<p>Taking $\varepsilon_2\to 1^{-}$ (and using continuity of $f$) shows the same bound holds when $\varepsilon_2 = 1$. Hence, for all $0 \leq \varepsilon_1 < \varepsilon_2 \leq 1$,</p>$$
\Delta_\delta \geq \frac{\varepsilon_2^2 - \varepsilon_1^2}{2n}.
$$<blockquote><p><strong>Note.</strong> At $\varepsilon=1$, the factor $(1 - \varepsilon^2)^{\frac{1}{n} - 1}$ diverges (for $n > 2$), which only strengthens $(1 - \varepsilon^2)^{\frac{1}{n} - 1} \geq 1$ and $f'(\varepsilon) \geq \varepsilon/n$. The integral is interpreted as a limit <em>from below</em> when the upper limit is $1$.</p></blockquote><h4 id=decision-rule-and-sample-complexity>Decision rule and sample complexity<a hidden class=anchor aria-hidden=true href=#decision-rule-and-sample-complexity>#</a></h4><p>Define a margin</p>$$
t := \frac{\Delta_{\delta}}{2} = \frac{\delta_{\text{far}} - \delta_{\text{close}}}{2}.
$$<p>Pick a single cutoff inside the gap (the midpoint):</p>$$
c := \frac{\delta_{\text{close}} + \delta_{\text{far}}}{2} = \frac{f(\varepsilon_1) + f(\varepsilon_2)}{2}.
$$<p>After running the protocol and computing the empirical mismatch rate $\hat\delta$ on the matching‚Äëbasis rounds $S$, we define the decision rule as</p>$$
\text{Decision} =
\begin{cases}
\text{‚Äúclose‚Äù} & \text{if } \hat\delta \leq c,\\
\text{‚Äúfar‚Äù} & \text{if } \hat\delta > c.
\end{cases}
$$<p>On matching‚Äëbasis rounds, the indicators $\{ Y_i \}_{i \in S}$ are i.i.d. Bernoulli random variables with mean $\delta$. Chernoff‚ÄìHoeffding gives, for any $t > 0$,</p>$$
\Pr\!\left[|\hat\delta - \delta| \geq t\right] \leq 2e^{-2|S|t^2}.
$$<ul><li><p><strong>Completeness</strong> ($\delta \leq \delta_{\text{close}}$):
If the <em>good</em> event $|\hat\delta - \delta| < t$ holds, then
$\hat\delta \leq \delta_{\text{close}} + t = c \Rightarrow$ accept.</p></li><li><p><strong>Soundness</strong> ($\delta \geq \delta_{\text{far}}$):
If $|\hat\delta-\delta| < t$, then
$\hat\delta > \delta_{\text{far}} - t = c \Rightarrow$ reject.</p></li></ul><p>Therefore, each error (completeness or soundness) occurs only if $|\hat\delta-\delta|\geq t$ (the bad event). To make this probability $\leq \alpha$, it suffices that</p>$$
2e^{-2|S|t^2} \leq \alpha
\quad\iff\quad
|S| \geq \frac{2}{\Delta_\delta^{2}}\,\ln\!\frac{2}{\alpha} \qquad (t = \Delta_\delta/2).
$$<p>The bound on $\Delta_\delta$ from the integral earlier states that</p>$$
\Delta_\delta \geq \frac{\varepsilon_2^2 - \varepsilon_1^2}{2n}.
$$<p>From this, we can derive that</p>$$
\begin{aligned}
\Delta_\delta ~\geq~ \frac{\varepsilon_2^2 - \varepsilon_1^2}{2n} &{\quad\iff\quad} \Delta_\delta^2 ~\geq~ \left(\frac{\varepsilon_2^2 - \varepsilon_1^2}{2n}\right)^2
\\[10pt]&{\quad\iff\quad} \Delta_\delta^2 ~\geq~ \frac{\left(\varepsilon_2^2 - \varepsilon_1^2\right)^2}{4n^2}
\\[10pt]&{\quad\iff\quad} \frac{1}{\Delta_\delta^2} ~\leq~ \frac{4n^2}{\left(\varepsilon_2^2 - \varepsilon_1^2\right)^2}
\\[15pt]&{\quad\iff\quad} \frac{2}{\Delta_\delta^2} \ln \frac{2}{\alpha} ~\leq~ \frac{8n^2}{\left( \varepsilon_2^2 - \varepsilon_1^2 \right)^2} \ln \frac{2}{\alpha} \quad[\,=: L\,].
\end{aligned}
$$<p>Since $\Delta_\delta \geq (\varepsilon_2^2 - \varepsilon_1^2)/(2n)$ and $\frac{2}{\Delta_\delta^2}\,\ln\!\frac{2}{\alpha}$ is strictly decreasing in $\Delta_\delta$, the true requirement is always at most $L$. Therefore, choosing $|S| \geq L$ guarantees the condition is satisfied for all admissible $\Delta_\delta$:</p>$$
|S| \geq \underbrace{\frac{8\,n^2}{\left( \varepsilon_2^2 - \varepsilon_1^2 \right)^2}\,\ln\!\frac{2}{\alpha}}_{\text{Our choice (worst-case }L\text{)}}
\quad\geq\quad
\underbrace{\frac{2}{\Delta_\delta^{2}}\,\ln\!\frac{2}{\alpha}}_{\text{What we actually need}}.
$$<p>In other words, a sufficient condition for $|S|$ is:</p>$$
|S| ~\geq~ \frac{8\,n^2}{\left( \varepsilon_2^2 - \varepsilon_1^2 \right)^2}\,\ln\!\frac{2}{\alpha}.
$$<p>As before, only about half of the $N$ rounds are matching-basis. Taking $N = 4|S|$ (by the same argument from the single-copy case),</p>$$
N ~\geq~ \frac{32\,n^2}{\left( \varepsilon_2^2 - \varepsilon_1^2 \right)^2}\,\ln\!\frac{2}{\alpha} \qquad\left[= O\left(n^2\left(\varepsilon_2^2 - \varepsilon_1^2\right)^{-2}\right)\right].
$$<p>So it turns out that extending the test from a single copy to $n$ i.i.d. copies is <strong>not</strong> free: the price is a quadratic blow-up in sample complexity, which is intuitive and expected when you consider the difference in the guarantees. Certifying that the <em>entire collection</em> of $n$ states is globally $\varepsilon$-close is a much stricter requirement than certifying a single state. This is because a tiny imperfection in each copy, when compounded over the tensor product of all $n$ states, can result in a large global deviation. To compensate for this, the required fidelity of each copy must be much higher. This in turn forces the promise gap $\Delta_\delta$ for the true error rate $\delta$ to become approximately $n$ times narrower, squeezing the thresholds for &ldquo;close&rdquo; and &ldquo;far&rdquo; states into a much smaller window near zero.</p><p>The reason for this is that our promise is about the <strong>global state</strong> of all $n$ copies. For the global state to be nearly perfect (i.e., have a high global fidelity $F_n = F_1^n$), the fidelity of each <strong>single copy</strong> ($F_1$) must be extremely close to $1$. Since the true error rate $\delta$ is a direct measure of the imperfection in a single copy, this extremely high fidelity requirement forces $\delta$ to be (comparatively) much smaller than it would be in the single-copy test. As a result, this effectively &ldquo;squeezes&rdquo; the entire range of relevant error rates into a tiny window near zero, which makes the absolute gap between our $\delta_{\text{close}}$ and $\delta_{\text{far}}$ thresholds narrower.</p><p>A core principle of statistics is that the uncertainty of an estimated average is proportional to the inverse square root of the number of samples (in our case, this is $1 / \sqrt{|S|}$). To reliably measure a promise gap that is $n$ times smaller, our estimate for $\Delta_\delta$ must be $n$ times more precise. Achieving this $n$-fold increase in precision requires an $n^2$-fold increase in the number of samples, which leads directly to the $O(n^2)$ scaling in complexity we&rsquo;re seeing. Putting everything together succinctly:</p><blockquote><p><strong>Theorem (Finite-sample tolerant EPR identity test, i.i.d. product version).</strong></p><p>Let $n \geq 2$ be the number of i.i.d. copies of $\rho_{AB}$ held by Alice and Bob. For brevity, write</p>$$
\rho = \rho_{AB},\qquad \Phi=\ket{\mathrm{EPR}}\bra{\mathrm{EPR}}_{AB}.
$$<p>Fix global trace-distance tolerances $0 \leq \varepsilon_1 < \varepsilon_2 \leq 1$ and confidence $1 - \alpha$. Define</p>$$
\begin{aligned}
&f(\varepsilon) = \frac{1}{2}\!\left[1 - (1 - \varepsilon^2)^{1/n}\right]&,&
&\delta_{\text{close}} = f(\varepsilon_1),
\\[10pt]&\delta_{\text{far}} = f(\varepsilon_2)&,&
\qquad &c = \frac{\delta_{\text{close}} + \delta_{\text{far}}}{2}.
\end{aligned}
$$<p>Run the matching-outcomes protocol for</p>$$
N ~\geq~ \frac{32\,n^2}{\left( \varepsilon_2^2 - \varepsilon_1^2 \right)^2}\,\ln\!\frac{2}{\alpha}
\qquad\left[= O\left(n^2\left(\varepsilon_2^2 - \varepsilon_1^2\right)^{-2}\right)\right]
$$<p>rounds, and accept <em>if and only if</em> the observed error $\hat{\delta} \leq c$. Then:</p><ul><li>If $D(\rho^{\otimes n},\Phi^{\otimes n}) \leq \varepsilon_1$, the test accepts with probability $\geq 1 - \alpha$.</li><li>If $D(\rho^{\otimes n},\Phi^{\otimes n}) \geq \varepsilon_2$, the test rejects with probability $\geq 1 - \alpha$.</li><li>If $\varepsilon_1 < D(\rho^{\otimes n},\Phi^{\otimes n}) < \varepsilon_2$, no guarantee is provided; the test may accept or reject.</li></ul></blockquote><p>That completes the &ldquo;easy&rdquo; i.i.d. case. Next, we&rsquo;ll remove the identical-copy assumption.</p><hr><h2 id=medium-case-independent-non-identical-copies>Medium case (independent, non-identical copies)<a hidden class=anchor aria-hidden=true href=#medium-case-independent-non-identical-copies>#</a></h2><p><code>copy from obsidian</code>
<code>todo: maybe now we can use the same sufficiency/necessity argument and we can finish off the closeness part of the medium case</code></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://teaegg.net/research/urss/epr-tolerant-identity-testing/><span class=title>¬´ Prev</span><br><span>Classical tolerant identity test for the EPR state</span></a></nav></footer></article></main><footer class=footer><span>¬© 2025 ∆¨·òø·ó© ·òø·òú·òú ‚ñ∂Ô∏é ‚Ä¢·Åä·Åä||·Åä|·Åã|||| | ¬∑ Built by Howard ìÜ©ìÇÄìÜ™
<span class=only-desktop>¬∑ Powered by
<a href=https://gohugo.io>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod>PaperMod</a></span></span></footer><a href=#top aria-label="go to top" title="Go to Top" class=top-link id=top-link><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>(function(){const n=document.getElementById("greeting");if(!n)return;const e=(new Date).getHours();let t;e>=6&&e<12?t="ÍßÅ …¢÷Ö÷Ö÷Ö…ñ  ç÷Ö Ä’º…®’º…¢! üåª ÍßÇ":e>=12&&e<18?t="ùêÜùê®ùê®ùêù ùêöùêüùê≠ùêûùê´ùêßùê®ùê®ùêß. ‚òÄÔ∏èüå≥‚òï":e>=18&&e<22?t="ùòéùò∞ùò∞ùò• ùò¶ùò∑ùò¶ùòØùò™ùòØùò®. üåÑüõãÔ∏èüìñ":t="ùïôùïñùï™ ùïüùïöùïòùïôùï• ùï†ùï®ùïù... ü¶âüåôüåÉ",n.textContent=t})()</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>