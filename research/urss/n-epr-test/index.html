<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Classical tolerant identity test for multiple EPR states | ùóßùóòùóî‚Ä¢ùóòùóöùóö</title><meta name=keywords content><meta name=description content="With the tolerant identity test for a single state $\rho_{AB}$ complete, we now turn to the problem of certifying multiple EPR pairs. For brevity we write

$$
\rho = \rho_{AB},
\qquad
\Phi = \ket{\text{EPR}}\bra{\text{EPR}}_{AB}.
$$In particular, we will show how the same matching-outcomes protocol extends in three settings of increasing generality and difficulty:


Easy (i.i.d. copies).
All $n$ copies are identical:

$$
     \rho^{\otimes n}\quad\text{vs.}\quad\Phi^{\otimes n}.
   $$

Medium (independent, non-identical copies).
Each copy may differ but remains uncorrelated:
"><meta name=author content="Howard Cheung"><link rel=canonical href=https://teaegg.net/research/urss/n-epr-test/><link crossorigin=anonymous href=/assets/css/stylesheet.38c7824e012d1aa77ec585e43f575f517d9a28fd6d4dcc9388d33ee8728c3570.css integrity="sha256-OMeCTgEtGqd+xYXkP1dfUX2aKP1tTcyTiNM+6HKMNXA=" rel="preload stylesheet" as=style><link rel=icon href=https://teaegg.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://teaegg.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://teaegg.net/favicon-32x32.png><link rel=apple-touch-icon href=https://teaegg.net/apple-touch-icon.png><link rel=mask-icon href=https://teaegg.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://teaegg.net/research/urss/n-epr-test/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\[",right:"\\]",display:!0},{left:"\\(",right:"\\)",display:!1}]})})</script><link rel=icon type=image/png href=/favicon-96x96.png sizes=96x96><link rel=icon type=image/svg+xml href=/favicon.svg><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><meta name=apple-mobile-web-app-title content="Teaegg"><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://teaegg.net/research/urss/n-epr-test/"><meta property="og:site_name" content="ùóßùóòùóî‚Ä¢ùóòùóöùóö"><meta property="og:title" content="Classical tolerant identity test for multiple EPR states"><meta property="og:description" content="With the tolerant identity test for a single state $\rho_{AB}$ complete, we now turn to the problem of certifying multiple EPR pairs. For brevity we write $$ \rho = \rho_{AB}, \qquad \Phi = \ket{\text{EPR}}\bra{\text{EPR}}_{AB}. $$In particular, we will show how the same matching-outcomes protocol extends in three settings of increasing generality and difficulty:
Easy (i.i.d. copies).
All $n$ copies are identical: $$ \rho^{\otimes n}\quad\text{vs.}\quad\Phi^{\otimes n}. $$ Medium (independent, non-identical copies).
Each copy may differ but remains uncorrelated: "><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="research"><meta property="article:published_time" content="2025-08-08T17:42:31+01:00"><meta property="article:modified_time" content="2025-08-08T17:42:31+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Classical tolerant identity test for multiple EPR states"><meta name=twitter:description content="With the tolerant identity test for a single state $\rho_{AB}$ complete, we now turn to the problem of certifying multiple EPR pairs. For brevity we write

$$
\rho = \rho_{AB},
\qquad
\Phi = \ket{\text{EPR}}\bra{\text{EPR}}_{AB}.
$$In particular, we will show how the same matching-outcomes protocol extends in three settings of increasing generality and difficulty:


Easy (i.i.d. copies).
All $n$ copies are identical:

$$
     \rho^{\otimes n}\quad\text{vs.}\quad\Phi^{\otimes n}.
   $$

Medium (independent, non-identical copies).
Each copy may differ but remains uncorrelated:
"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"üî¨ Research","item":"https://teaegg.net/research/"},{"@type":"ListItem","position":2,"name":"üîêüí° Undergraduate Research Support Scheme (URSS)","item":"https://teaegg.net/research/urss/"},{"@type":"ListItem","position":3,"name":"Classical tolerant identity test for multiple EPR states","item":"https://teaegg.net/research/urss/n-epr-test/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Classical tolerant identity test for multiple EPR states","name":"Classical tolerant identity test for multiple EPR states","description":"With the tolerant identity test for a single state $\\rho_{AB}$ complete, we now turn to the problem of certifying multiple EPR pairs. For brevity we write $$ \\rho = \\rho_{AB}, \\qquad \\Phi = \\ket{\\text{EPR}}\\bra{\\text{EPR}}_{AB}. $$In particular, we will show how the same matching-outcomes protocol extends in three settings of increasing generality and difficulty:\nEasy (i.i.d. copies).\nAll $n$ copies are identical: $$ \\rho^{\\otimes n}\\quad\\text{vs.}\\quad\\Phi^{\\otimes n}. $$ Medium (independent, non-identical copies).\nEach copy may differ but remains uncorrelated: ","keywords":[],"articleBody":"With the tolerant identity test for a single state $\\rho_{AB}$ complete, we now turn to the problem of certifying multiple EPR pairs. For brevity we write $$ \\rho = \\rho_{AB}, \\qquad \\Phi = \\ket{\\text{EPR}}\\bra{\\text{EPR}}_{AB}. $$In particular, we will show how the same matching-outcomes protocol extends in three settings of increasing generality and difficulty:\nEasy (i.i.d. copies).\nAll $n$ copies are identical: $$ \\rho^{\\otimes n}\\quad\\text{vs.}\\quad\\Phi^{\\otimes n}. $$ Medium (independent, non-identical copies).\nEach copy may differ but remains uncorrelated: $$ \\rho_1\\otimes\\rho_2\\otimes\\dots\\otimes\\rho_n \\quad\\text{vs.}\\quad \\Phi^{\\otimes n}. $$ Hard (arbitrary adversary).\nThe most general case allows an arbitrary $2n$-qubit state $\\rho$, possibly entangled across copies, against which we still wish to test closeness to $\\Phi^{\\otimes n}$.\nWe will analyse the number of protocol rounds, $N$, required to certify $n$ EPR pairs.\nCan we achieve the same sample complexity $$ N = O\\!\\left(n^4\\,(\\varepsilon_2^2 - \\varepsilon_1^2)^{-2}\\right)\\!. $$ in all three cases? idk\nNote. In the context of BB'84, these three scenarios correspond directly to the class of attacks that an eavesdropper (Eve) might do:\nEasy (i.i.d. copies): Eve applies the same attack channel to each transmitted qubit independently, with no memory from one round to the next. Every round she starts from scratch, so her joint state is $\\rho^{\\otimes n}$.\nMedium (independent, non-identical copies): Eve still treats each qubit independently and measures immediately, but she may choose a different attack in each round. Her overall state is the product $\\rho_{1}\\otimes\\rho_{2}\\otimes\\dots\\otimes\\rho_{n}$.\nHard (arbitrary adversary): Eve may entangle her systems across rounds and defer all measurements until the end. There is no tensor-product structure, so her state is an arbitrary $2n$-qubit $\\rho$.\nBy proving security in each model, starting with the easiest and working up to the fully coherent setting, we obtain a hierarchy of BB'84 security guarantees that mirror the increasing power of potential attack by Eve. From the sample complexity, we will see that a fully coherent attack (hard case) isn‚Äôt more difficult to detect than a simple i.i.d. tensor product state (easy case)! \u003c- not sure about this yet\nWe begin with the i.i.d. case as it‚Äôs both the simplest to analyse and a useful building block for the more challenging scenarios.\nEasy case (i.i.d. copies) A na√Øve per-copy approach using trace distance A first idea is to ignore the joint state altogether and simply run the single-pair tolerant test on each of the $n$ copies separately, then accept only if every individual test passes. Equivalently, one could tally the per-copy mismatch indicators into a total error count and compare that sum against a scaled threshold (thanks to the i.i.d. assumption). At first glance this seems painless, but a closer look shows it is actually worse than the collective strategy developed below.\nRecall for a single copy $\\rho$: $$ D_1 ~=~ D(\\rho,\\Phi), $$ and in the $n$-copy i.i.d. case we have the bound $$ D_n ~:=~ D\\bigl(\\rho^{\\otimes n},\\,\\Phi^{\\otimes n}\\bigr) ~\\leq~ n\\,D_1. $$ Per-copy tolerance must shrink. To guarantee that the full product state satisfies $D(\\rho^{\\otimes n},\\Phi^{\\otimes n}) \\leq \\varepsilon_1$, the trace-distance of each copy must be at most $\\varepsilon_1/n$; otherwise the sub-additivity bound $D_n\\leq nD_1$ could exceed $\\varepsilon_1$.\nPromise gap narrows by a factor $n$. Replacing $\\varepsilon_j$ by $\\varepsilon_j/n$ shrinks the gap $\\varepsilon_2^2 - \\varepsilon_1^2$ by $n^{2}$. For the single-pair test the sample size scales as the inverse square of that gap, so one copy now needs $$ O\\bigl(n^{4}(\\varepsilon_2^2-\\varepsilon_1^2)^{-2}\\bigr) $$ samples.\nUnion bound over $n$ copies. Running $n$ such tests and combining them with a union bound multiplies the sample cost by another factor $n$.\nHence the na√Øve strategy costs $$ N_{\\text{na√Øve}} ~=~ O\\bigl(n^{5}(\\varepsilon_2^2-\\varepsilon_1^2)^{-2}\\bigr), $$ which is one full power of $n$ ($n^{5}$ vs. $n^{4}$) worse than the collective $n$-copy analysis we develop below. The lesson is that testing each pair in isolation achieves a stronger (per-copy) guarantee than we need and pays a steep statistical price; exploiting the product structure directly using just one global test is markedly more efficient.\nGlobal block test via fidelity For a single copy $\\rho$: $$ F_1 ~=~ F(\\rho,\\Phi), \\quad D_1 ~=~ D(\\rho,\\Phi), $$ and in the $n$-copy i.i.d. case we have the rules $$ F_n ~:=~ F\\bigl(\\rho^{\\otimes n},\\,\\Phi^{\\otimes n}\\bigr) ~=~ F_1^{n}, \\qquad D_n ~:=~ D\\bigl(\\rho^{\\otimes n},\\,\\Phi^{\\otimes n}\\bigr) ~\\leq~ n\\,D_1. $$We switch to fidelity because it multiplies exactly under tensor powers: $F(\\rho^{\\otimes n},\\Phi^{\\otimes n}) = F(\\rho,\\Phi)^n$. This means that we can rewrite the $n$-copy test as a per-copy promise, and only at the very end convert back to trace distance via Fuchs‚Äìvan de Graaf. In contrast, trace distance only obeys the looser sub-additivity bound $D(\\rho^{\\otimes n},\\Phi^{\\otimes n}) \\leq n\\,D(\\rho,\\Phi)$, which, as we‚Äôve seen, would introduce an unwieldy factor of $n$ and weaken our bounds.\nOur goal is to distinguish $$ \\begin{cases} ~\\text{H}_0: \u0026D_n \\,\\leq\\,\\varepsilon_1 \\quad\\iff\\quad \\rho^{\\otimes n}\\text{ is ‚Äúclose‚Äù to }\\Phi^{\\otimes n},\\\\[6pt] ~\\text{H}_1: \u0026D_n \\,\\geq\\,\\varepsilon_2 \\quad\\iff\\quad \\rho^{\\otimes n}\\text{ is ‚Äúfar‚Äù from }\\Phi^{\\otimes n}, \\end{cases} $$ with $0 \\leq \\varepsilon_1 \u003c \\varepsilon_2 \\leq 1$. By Fuchs‚Äìvan de Graaf, $$ 1 - F_n ~\\leq~ D_n ~\\leq~ \\sqrt{1 - F_n^{2}}, $$ so controlling $F_n$ tightly leads to a corresponding control on $D_n$. Since $F_n = F_1^{n}$, we can use this and the left half of Fuchs‚Äìvan de Graaf to rewrite the hypotheses as fidelity conditions per-copy: $$ \\begin{aligned} \\text{H}_0: \\quad F_1^n ~\\geq~ 1 - \\varepsilon_1 \u0026\\quad\\iff\\quad F_1 ~\\geq~ (1 - \\varepsilon_1)^{1/n} ~=:~1-\\tilde{\\varepsilon}_1,\\\\[4pt] \\text{H}_1: \\quad F_1^n ~\\leq~ 1 - \\varepsilon_2 \u0026\\quad\\iff\\quad F_1 ~\\leq~ (1 - \\varepsilon_2)^{1/n} ~=:~ 1 - \\tilde{\\varepsilon}_2, \\end{aligned} $$ where $0 \u003c \\tilde{\\varepsilon}_1 \u003c \\tilde{\\varepsilon}_2$. For moderate $n$ one often uses the first-order approximation $$ \\tilde{\\varepsilon}_j \\approx \\frac{\\varepsilon_j}{n}, $$ but nothing in the proof requires it. In the single-copy tolerant test we set matching-basis error thresholds $$ \\delta_{\\text{close}} = \\frac{\\varepsilon_1^2}{2}, \\quad \\delta_{\\text{far}} = \\frac{\\varepsilon_2^2}{2}, $$ and chose a cutoff $$ c = \\frac{\\delta_{\\text{close}} + \\delta_{\\text{far}}}{2} = \\frac{\\varepsilon_1^2 + \\varepsilon_2^2}{4}, $$ then showed $$ |S| \\geq \\frac{8\\,\\ln(2/\\alpha)}{(\\varepsilon_2^2-\\varepsilon_1^2)^2} $$samples suffice. In the $n$-copy test we simply replace each $\\varepsilon_j$ by its rescaled $\\tilde\\varepsilon_j$: $$ \\tilde{\\delta}_{\\text{close}} =\\frac12\\,\\tilde{\\varepsilon}_1^{\\,2}, \\quad \\tilde{\\delta}_{\\text{far}} =\\frac12\\,\\tilde{\\varepsilon}_2^{\\,2}. $$ Everything in the finite-sample proof carries over verbatim, except that the promise gap shrinks by a factor $n$, the number of i.i.d. copies: $$ \\varepsilon_2^2-\\varepsilon_1^2 \\quad\\longrightarrow\\quad \\tilde\\varepsilon_2^{\\,2}-\\tilde\\varepsilon_1^{\\,2} ~\\approx~ \\frac{\\varepsilon_2^{2}-\\varepsilon_1^{2}}{n^{2}}. $$ The same Chernoff-Hoeffding argument yields $$ |S| ~\\geq~ \\frac{8\\,\\ln(2/\\alpha)}{\\left((\\varepsilon_2^2-\\varepsilon_1^2)/n^2\\right)^2} ~=~ \\frac{8\\,n^4\\,\\ln(2/\\alpha)}{(\\varepsilon_2^2-\\varepsilon_1^2)^2} \\qquad\\left[= O\\bigl(n^{4}\\,(\\varepsilon_2^2-\\varepsilon_1^2)^{-2}\\bigr)\\right]. $$ Taking $N=4|S|$ rounds then guarantees both completeness and soundness at the confidence level $1 - \\alpha$. So the i.i.d. extension is indeed ‚Äútrivial‚Äù algorithmically (exact same test), but not free: the price is a quartic blow-up in $n$ coming from the much narrower promise gap.\nBack-of-envelope: If your original single-pair tolerances were $\\varepsilon_1 \u003c \\varepsilon_2$ and you move to $n = 10$ copies with the same global promises, the promise gap $\\Delta = \\varepsilon_2^2 - \\varepsilon_1^2$ is divided by a factor $n^2 = 100$. Since the sample complexity scales as $O(\\Delta^{-2})$, this multiplies the cost by $n^4 = 10^4$, meaning you need roughly ten-thousand times more matching-basis samples than in the single-pair test.\nPut succinctly:\nTheorem (Finite-sample tolerant EPR identity test, i.i.d. product version).\nLet $n \\in \\mathbb{N}$ be the number of i.i.d. copies of $\\rho_{AB}$ held by Alice and Bob. For brevity write $$ \\rho = \\rho_{AB}, \\qquad \\Phi = \\ket{\\text{EPR}}\\bra{\\text{EPR}}_{AB}. $$ Fix global trace distance tolerances $0\\leq \\varepsilon_1\u003c\\varepsilon_2\\le1$ and confidence $1-\\alpha$. Define the cutoff $$ \\tilde{c} = \\frac{\\tilde{\\varepsilon}_1^{\\,2}+\\tilde{\\varepsilon}_2^{\\,2}}{4}, \\quad\\text{where}\\quad \\tilde{\\varepsilon}_j=(1-\\varepsilon_j)^{1/n} ~~\\text{ for } j \\in \\{1, 2\\}. $$ Run the matching-outcomes protocol for $$ N ~\\geq~ \\frac{32\\,n^4\\,\\ln(2/\\alpha)}{\\left(\\varepsilon_2^2 - \\varepsilon_1^2\\right)^{2}} \\qquad\\left[= O\\left(n^4\\,\\left(\\varepsilon_2^2 - \\varepsilon_1^2\\right)^{-2}\\right)\\right] $$ rounds, and accept if and only if the observed error $\\hat{\\delta} \\leq \\tilde{c}$. Then with probability $\\geq 1 - \\alpha$:\nIf $D(\\rho^{\\otimes n},\\Phi^{\\otimes n}) \\leq \\varepsilon_1$, the test accepts. If $D(\\rho^{\\otimes n},\\Phi^{\\otimes n}) \\geq \\varepsilon_2$, the test rejects. If $\\varepsilon_1 \u003c D(\\rho^{\\otimes n},\\Phi^{\\otimes n}) \u003c \\varepsilon_2$, no guarantee is provided; the test may accept or reject. That completes the ‚Äúeasy‚Äù i.i.d. case. Next, we‚Äôll remove the identical-copy assumption. maybe add the more specific case here that requires a stricter choice for \\varepsilon_1 and \\varepsilon_2\nMedium case (independent, non-identical copies) copy from obsidian\n","wordCount":"1309","inLanguage":"en","datePublished":"2025-08-08T17:42:31+01:00","dateModified":"2025-08-08T17:42:31+01:00","author":{"@type":"Person","name":"Howard Cheung"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://teaegg.net/research/urss/n-epr-test/"},"publisher":{"@type":"Organization","name":"ùóßùóòùóî‚Ä¢ùóòùóöùóö","logo":{"@type":"ImageObject","url":"https://teaegg.net/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://teaegg.net/ title=Home>ùóßùóòùóî‚Ä¢ùóòùóöùóö</a><div class=logo-switches><button id=theme-toggle title="Toggle theme" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://teaegg.net/aboutme/ title="About Me"><span>About Me</span></a></li><li><a href=https://teaegg.net/journal/ title=Journal><span>Journal</span></a></li><li><a href=https://teaegg.net/research/ title=Research><span>Research</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://teaegg.net/>üè† Home</a>&nbsp;¬ª&nbsp;<a href=https://teaegg.net/research/>üî¨ Research</a>&nbsp;¬ª&nbsp;<a href=https://teaegg.net/research/urss/>üîêüí° Undergraduate Research Support Scheme (URSS)</a></div><h1 class="post-title entry-hint-parent">Classical tolerant identity test for multiple EPR states</h1><div class=post-meta><span title='2025-08-08 17:42:31 +0100 +0100'>August 8, 2025</span>&nbsp;¬∑&nbsp;7 min&nbsp;¬∑&nbsp;Howard Cheung</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#easy-case-iid-copies aria-label="Easy case (i.i.d. copies)">Easy case (i.i.d. copies)</a><ul><li><a href=#a-na%c3%afve-per-copy-approach-using-trace-distance aria-label="A na√Øve per-copy approach using trace distance">A na√Øve per-copy approach using trace distance</a></li><li><a href=#global-block-test-via-fidelity aria-label="Global block test via fidelity">Global block test via fidelity</a></li></ul></li><li><a href=#medium-case-independent-non-identical-copies aria-label="Medium case (independent, non-identical copies)">Medium case (independent, non-identical copies)</a></li></ul></div></details></div><div class=post-content><p>With the <a href=../epr-tolerant-identity-testing>tolerant identity test</a> for a single state $\rho_{AB}$ complete, we now turn to the problem of certifying multiple EPR pairs. For brevity we write</p>$$
\rho = \rho_{AB},
\qquad
\Phi = \ket{\text{EPR}}\bra{\text{EPR}}_{AB}.
$$<p>In particular, we will show how the same matching-outcomes protocol extends in three settings of increasing generality and difficulty:</p><ol><li><p><strong>Easy (i.i.d. copies).</strong></p><p>All $n$ copies are identical:</p>$$
\rho^{\otimes n}\quad\text{vs.}\quad\Phi^{\otimes n}.
$$</li><li><p><strong>Medium (independent, non-identical copies).</strong></p><p>Each copy may differ but remains uncorrelated:</p>$$
\rho_1\otimes\rho_2\otimes\dots\otimes\rho_n
\quad\text{vs.}\quad
\Phi^{\otimes n}.
$$</li><li><p><strong>Hard (arbitrary adversary).</strong></p><p>The most general case allows an arbitrary $2n$-qubit state $\rho$, possibly entangled across copies, against which we still wish to test closeness to $\Phi^{\otimes n}$.</p></li></ol><p>We will analyse the number of protocol rounds, $N$, required to certify $n$ EPR pairs.</p><p><del>Can we achieve the same sample complexity
$$
N = O\!\left(n^4\,(\varepsilon_2^2 - \varepsilon_1^2)^{-2}\right)\!.
$$
in all three cases?</del> <code>idk</code></p><blockquote><p><strong>Note.</strong> In the context of BB'84, these three scenarios correspond directly to the class of attacks that an eavesdropper (Eve) might do:</p><ul><li><p><strong>Easy (i.i.d. copies)</strong>:
Eve applies the same attack channel to each transmitted qubit independently, with no memory from one round to the next. Every round she starts from scratch, so her joint state is $\rho^{\otimes n}$.</p></li><li><p><strong>Medium (independent, non-identical copies)</strong>:
Eve still treats each qubit independently and measures immediately, but she may choose a different attack in each round. Her overall state is the product $\rho_{1}\otimes\rho_{2}\otimes\dots\otimes\rho_{n}$.</p></li><li><p><strong>Hard (arbitrary adversary)</strong>:
Eve may entangle her systems across rounds and defer all measurements until the end. There is no tensor-product structure, so her state is an arbitrary $2n$-qubit $\rho$.</p></li></ul><p>By proving security in each model, starting with the easiest and working up to the fully coherent setting, we obtain a hierarchy of BB'84 security guarantees that mirror the increasing power of potential attack by Eve. <del>From the sample complexity, we will see that a fully coherent attack (hard case) isn&rsquo;t more difficult to detect than a simple i.i.d. tensor product state (easy case)!</del> <code>&lt;- not sure about this yet</code></p></blockquote><p>We begin with the i.i.d. case as it&rsquo;s both the simplest to analyse and a useful building block for the more challenging scenarios.</p><h2 id=easy-case-iid-copies>Easy case (i.i.d. copies)<a hidden class=anchor aria-hidden=true href=#easy-case-iid-copies>#</a></h2><h3 id=a-na√Øve-per-copy-approach-using-trace-distance>A na√Øve per-copy approach using trace distance<a hidden class=anchor aria-hidden=true href=#a-na√Øve-per-copy-approach-using-trace-distance>#</a></h3><p>A first idea is to ignore the joint state altogether and simply run the <strong>single-pair</strong> tolerant test on each of the $n$ copies <strong>separately</strong>, then accept only if every individual test passes. Equivalently, one could tally the per-copy mismatch indicators into a total error count and compare that sum against a scaled threshold (thanks to the i.i.d. assumption). At first glance this seems painless, but a closer look shows it is actually <em>worse</em> than the collective strategy developed below.</p><p>Recall for a single copy $\rho$:</p>$$
D_1 ~=~ D(\rho,\Phi),
$$<p>and in the $n$-copy i.i.d. case we have the bound</p>$$
D_n ~:=~ D\bigl(\rho^{\otimes n},\,\Phi^{\otimes n}\bigr) ~\leq~ n\,D_1.
$$<ul><li><p><strong>Per-copy tolerance must shrink.</strong>
To guarantee that the full product state satisfies $D(\rho^{\otimes n},\Phi^{\otimes n}) \leq \varepsilon_1$, the trace-distance of <em>each</em> copy must be at most $\varepsilon_1/n$; otherwise the sub-additivity bound $D_n\leq nD_1$ could exceed $\varepsilon_1$.</p></li><li><p><strong>Promise gap narrows by a factor $n$.</strong>
Replacing $\varepsilon_j$ by $\varepsilon_j/n$ shrinks the gap $\varepsilon_2^2 - \varepsilon_1^2$ by $n^{2}$. For the single-pair test the sample size scales as the inverse square of that gap, so one copy now needs</p>$$
O\bigl(n^{4}(\varepsilon_2^2-\varepsilon_1^2)^{-2}\bigr)
$$<p>samples.</p></li><li><p><strong>Union bound over $n$ copies.</strong>
Running $n$ such tests and combining them with a union bound multiplies the sample cost by another factor $n$.</p></li></ul><p>Hence the na√Øve strategy costs</p>$$
N_{\text{na√Øve}} ~=~ O\bigl(n^{5}(\varepsilon_2^2-\varepsilon_1^2)^{-2}\bigr),
$$<p>which is one full power of $n$ ($n^{5}$ vs. $n^{4}$) worse than the collective $n$-copy analysis we develop below. The lesson is that testing each pair in isolation achieves a <em>stronger</em> (per-copy) guarantee than we need and pays a steep statistical price; exploiting the product structure directly using just one global test is markedly more efficient.</p><h3 id=global-block-test-via-fidelity>Global block test via fidelity<a hidden class=anchor aria-hidden=true href=#global-block-test-via-fidelity>#</a></h3><p>For a single copy $\rho$:</p>$$
F_1 ~=~ F(\rho,\Phi),
\quad
D_1 ~=~ D(\rho,\Phi),
$$<p>and in the $n$-copy i.i.d. case we have the rules</p>$$
F_n ~:=~ F\bigl(\rho^{\otimes n},\,\Phi^{\otimes n}\bigr) ~=~ F_1^{n},
\qquad
D_n ~:=~ D\bigl(\rho^{\otimes n},\,\Phi^{\otimes n}\bigr) ~\leq~ n\,D_1.
$$<p>We switch to fidelity because it multiplies exactly under tensor powers: $F(\rho^{\otimes n},\Phi^{\otimes n}) = F(\rho,\Phi)^n$. This means that we can rewrite the $n$-copy test as a per-copy promise, and only at the very end convert back to trace distance via Fuchs‚Äìvan de Graaf. In contrast, trace distance only obeys the looser sub-additivity bound $D(\rho^{\otimes n},\Phi^{\otimes n}) \leq n\,D(\rho,\Phi)$, which, as we&rsquo;ve seen, would introduce an unwieldy factor of $n$ and weaken our bounds.</p><p>Our goal is to distinguish</p>$$
\begin{cases}
~\text{H}_0: &D_n \,\leq\,\varepsilon_1
\quad\iff\quad \rho^{\otimes n}\text{ is ‚Äúclose‚Äù to }\Phi^{\otimes n},\\[6pt]
~\text{H}_1: &D_n \,\geq\,\varepsilon_2
\quad\iff\quad \rho^{\otimes n}\text{ is ‚Äúfar‚Äù from }\Phi^{\otimes n},
\end{cases}
$$<p>with $0 \leq \varepsilon_1 < \varepsilon_2 \leq 1$. By Fuchs‚Äìvan de Graaf,</p>$$
1 - F_n ~\leq~ D_n ~\leq~ \sqrt{1 - F_n^{2}},
$$<p>so controlling $F_n$ tightly leads to a corresponding control on $D_n$. Since $F_n = F_1^{n}$, we can use this and the left half of Fuchs‚Äìvan de Graaf to rewrite the hypotheses as fidelity conditions per-copy:</p>$$
\begin{aligned}
\text{H}_0: \quad F_1^n ~\geq~ 1 - \varepsilon_1
&\quad\iff\quad
F_1 ~\geq~ (1 - \varepsilon_1)^{1/n}
~=:~1-\tilde{\varepsilon}_1,\\[4pt]
\text{H}_1: \quad F_1^n ~\leq~ 1 - \varepsilon_2
&\quad\iff\quad
F_1 ~\leq~ (1 - \varepsilon_2)^{1/n}
~=:~ 1 - \tilde{\varepsilon}_2,
\end{aligned}
$$<p>where $0 < \tilde{\varepsilon}_1 < \tilde{\varepsilon}_2$. For moderate $n$ one often uses the first-order approximation</p>$$
\tilde{\varepsilon}_j \approx \frac{\varepsilon_j}{n},
$$<p>but nothing in the proof requires it. In the single-copy tolerant test we set matching-basis error thresholds</p>$$
\delta_{\text{close}} = \frac{\varepsilon_1^2}{2},
\quad
\delta_{\text{far}} = \frac{\varepsilon_2^2}{2},
$$<p>and chose a cutoff</p>$$
c = \frac{\delta_{\text{close}} + \delta_{\text{far}}}{2} = \frac{\varepsilon_1^2 + \varepsilon_2^2}{4},
$$<p>then showed</p>$$
|S| \geq \frac{8\,\ln(2/\alpha)}{(\varepsilon_2^2-\varepsilon_1^2)^2}
$$<p>samples suffice. In the $n$-copy test we simply replace each $\varepsilon_j$ by its rescaled $\tilde\varepsilon_j$:</p>$$
\tilde{\delta}_{\text{close}}
=\frac12\,\tilde{\varepsilon}_1^{\,2},
\quad
\tilde{\delta}_{\text{far}}
=\frac12\,\tilde{\varepsilon}_2^{\,2}.
$$<p>Everything in the finite-sample proof <em>carries over verbatim</em>, except that the <strong>promise gap</strong> shrinks by a factor $n$, the number of i.i.d. copies:</p>$$
\varepsilon_2^2-\varepsilon_1^2 \quad\longrightarrow\quad
\tilde\varepsilon_2^{\,2}-\tilde\varepsilon_1^{\,2}
~\approx~ \frac{\varepsilon_2^{2}-\varepsilon_1^{2}}{n^{2}}.
$$<p>The same Chernoff-Hoeffding argument yields</p>$$
|S| ~\geq~ \frac{8\,\ln(2/\alpha)}{\left((\varepsilon_2^2-\varepsilon_1^2)/n^2\right)^2} ~=~ \frac{8\,n^4\,\ln(2/\alpha)}{(\varepsilon_2^2-\varepsilon_1^2)^2}
\qquad\left[=
O\bigl(n^{4}\,(\varepsilon_2^2-\varepsilon_1^2)^{-2}\bigr)\right].
$$<p>Taking $N=4|S|$ rounds then guarantees both completeness and soundness at the confidence level $1 - \alpha$. So the i.i.d. extension is indeed &ldquo;trivial&rdquo; algorithmically (exact same test), but <strong>not</strong> free: the price is a quartic blow-up in $n$ coming from the much narrower promise gap.</p><blockquote><p><strong>Back-of-envelope:</strong> If your original single-pair tolerances were $\varepsilon_1 < \varepsilon_2$ and you move to $n = 10$ copies with the same global promises, the promise gap $\Delta = \varepsilon_2^2 - \varepsilon_1^2$ is <em>divided</em> by a factor $n^2 = 100$. Since the sample complexity scales as $O(\Delta^{-2})$, this multiplies the cost by $n^4 = 10^4$, meaning you need roughly ten-thousand times more matching-basis samples than in the single-pair test.</p></blockquote><p>Put succinctly:</p><blockquote><p><strong>Theorem (Finite-sample tolerant EPR identity test, i.i.d. product version).</strong></p><p>Let $n \in \mathbb{N}$ be the number of i.i.d. copies of $\rho_{AB}$ held by Alice and Bob. For brevity write</p>$$
\rho = \rho_{AB},
\qquad
\Phi = \ket{\text{EPR}}\bra{\text{EPR}}_{AB}.
$$<p>Fix global trace distance tolerances $0\leq \varepsilon_1<\varepsilon_2\le1$ and confidence $1-\alpha$. Define the cutoff</p>$$
\tilde{c} = \frac{\tilde{\varepsilon}_1^{\,2}+\tilde{\varepsilon}_2^{\,2}}{4},
\quad\text{where}\quad \tilde{\varepsilon}_j=(1-\varepsilon_j)^{1/n} ~~\text{ for } j \in \{1, 2\}.
$$<p>Run the matching-outcomes protocol for</p>$$
N ~\geq~ \frac{32\,n^4\,\ln(2/\alpha)}{\left(\varepsilon_2^2 - \varepsilon_1^2\right)^{2}}
\qquad\left[= O\left(n^4\,\left(\varepsilon_2^2 - \varepsilon_1^2\right)^{-2}\right)\right]
$$<p>rounds, and accept <em>if and only if</em> the observed error $\hat{\delta} \leq \tilde{c}$. Then with probability $\geq 1 - \alpha$:</p><ul><li>If $D(\rho^{\otimes n},\Phi^{\otimes n}) \leq \varepsilon_1$, the test accepts.</li><li>If $D(\rho^{\otimes n},\Phi^{\otimes n}) \geq \varepsilon_2$, the test rejects.</li><li>If $\varepsilon_1 < D(\rho^{\otimes n},\Phi^{\otimes n}) < \varepsilon_2$, no guarantee is provided; the test may accept or reject.</li></ul></blockquote><p>That completes the &ldquo;easy&rdquo; i.i.d. case. Next, we&rsquo;ll remove the identical-copy assumption.
<code>maybe add the more specific case here that requires a stricter choice for \varepsilon_1 and \varepsilon_2</code></p><h2 id=medium-case-independent-non-identical-copies>Medium case (independent, non-identical copies)<a hidden class=anchor aria-hidden=true href=#medium-case-independent-non-identical-copies>#</a></h2><p><code>copy from obsidian</code></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://teaegg.net/research/urss/epr-tolerant-identity-testing/><span class=title>¬´ Prev</span><br><span>Classical tolerant identity test for the EPR state</span></a></nav></footer></article></main><footer class=footer><span>¬© 2025 ∆¨·òø·ó© ·òø·òú·òú ‚ñ∂Ô∏é ‚Ä¢·Åä·Åä||·Åä|·Åã|||| | ¬∑ Built by Howard ìÜ©ìÇÄìÜ™
<span class=only-desktop>¬∑ Powered by
<a href=https://gohugo.io>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod>PaperMod</a></span></span></footer><a href=#top aria-label="go to top" title="Go to Top" class=top-link id=top-link><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>(function(){const n=document.getElementById("greeting");if(!n)return;const e=(new Date).getHours();let t;e>=6&&e<12?t="ÍßÅ …¢÷Ö÷Ö÷Ö…ñ  ç÷Ö Ä’º…®’º…¢! üåª ÍßÇ":e>=12&&e<18?t="ùêÜùê®ùê®ùêù ùêöùêüùê≠ùêûùê´ùêßùê®ùê®ùêß. ‚òÄÔ∏èüå≥‚òï":e>=18&&e<22?t="ùòéùò∞ùò∞ùò• ùò¶ùò∑ùò¶ùòØùò™ùòØùò®. üåÑüõãÔ∏èüìñ":t="ùïôùïñùï™ ùïüùïöùïòùïôùï• ùï†ùï®ùïù... ü¶âüåôüåÉ",n.textContent=t})()</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>